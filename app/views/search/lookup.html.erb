<% content_for :title, "Lookup users" %>
<%= content_for :stylesheet, (stylesheet_link_tag asset_path('stylesheets/template.css')) %>
<%= content_for :stylesheet, (stylesheet_link_tag asset_path('stylesheets/search.css')) %>
<% content_for :javascript, (javascript_include_tag asset_path('javascripts/searcher.js')) %>
<% content_for :javascript, (javascript_include_tag asset_path('javascripts/tabularResults.js')) %>
<% content_for :javascript, (javascript_include_tag asset_path('javascripts/custom.js')) %>
<%=render 'layouts/login_navbar' %>   

<!-- End Head Section --> 

<!-- Body Section Starts Here --> 




<div class="container"> 


<!--- page here -->

<div class="panel panel-default" >  
  <div class="panel-heading  text-center clearfix"> <span style="font-size:25px; line-height:30px;" class="text-center">  Select Your Search Criteria </span> 
<%= form_for :search, url: "user_search", method: :post, :html => {:id => "searchForm"} do |f| %>
  </div>
    <div class="panel-body">
        <div class="col-md-3">
          <div class="panel panel-default">
            <div class="panel-heading panel-heading-default">
             Affiliation 
            </div>
              <div class="panel-body panel-height-custom">
                <% User::AFFILIATIONS.each do |aff|%>
                    <div><%= check_box_tag "affiliations[]", aff %>
                    <%= f.label aff.titleize %></div>
                <% end %>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading panel-heading-default">
                    Instruments 
              </div>
                <div class="panel-body panel-height-custom">
                    <% @instruments.each do |ins| %>
                        <div><%= check_box_tag "instruments[]", ins.id %>
                        <%= f.label ins.name %></div>
                    <% end %>      
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading panel-heading-default">
                     Genre 
              </div>
                <div class="panel-body panel-height-custom">
                    <% @genres.each do |g| %>
                        <div><%= check_box_tag "genres[]", g.id %>
                        <%= f.label g.name %></div>
                    <% end %>
                </div>
            </div>
        </div>
        <div class="col-md-3" >
            <div class="panel panel-default">
                <div class="panel-heading panel-heading-default">
                     Interests 
                </div>
                <div class="panel-body panel-height-custom">
                    <% @interests.each do |a| %>
                        <div><%= check_box_tag "interests[]", a.id %>
                        <%= f.label a.name %></div>
                    <% end %>
                </div>
            </div>
            
        </div>
        
        
    <div class="panel-footer text-right"> 
        <%= f.submit "Search", :class => "btn btn-md btn-danger ", :role => "button", :id => "searchButton"%>
    <% end %>
        <input type="submit" class="btn btn-md btn-danger " role="button" onClick="$('input:checkbox').removeAttr('checked');" value="Clear">
    </div>
                
    </div>
 
    </div> 

<!-- Page here --> 




    <div class="panel panel-default" id="resultsTableDiv" hidden>
        <div class="panel-heading text-center panel-heading-lg" id="resultsHeader">
           
            Your Search Results
           
        </div>
        <table  class="table table-fixed table-hover table-striped" id="resultsTable">
          <thead>
            <tr>
              <th class="col-lg-1">###</th>
              <th class="col-lg-3">Name</th>
              <th class="col-lg-3">Email</th>
              <th class="col-lg-5">Instruments</th>
            </tr>
          </thead>
          
          <tbody id="resultsBody">
            <!-- Results Filled in here via AJAX call to '/search/user_search' API -->
          </tbody>
        </table>
      </div>
  
  
  
<!--   <div class="panel-footer text-right">
    <input type="submit" class="btn btn-md btn-danger " role="button" onClick="window.open('search-results.html')" value="Search">
  </div> -->
</div> 

</div>
</div>
    <%= javascript_tag " var searcher = new Searcher('result', 'searchForm', '/search/user_search', null, function(data) {
        if (data.status === 'SUCCESS') {
            $('#resultsTableDiv').show();
            fillResultsTable('resultsBody', 'resultsTable', data.data);
        } else {
            $('#resultsBody').empty();
            $('#resultsTableDiv').hide();
            console.log(data.message);
            var searchButton = document.getElementById('searchButton');
            console.log(searchButton);
            searchButton.setAttribute('title', data.message);
        }
    });
        searcher.submitForm();

    "%>
<!-- Body Section Ends Here --> 



<!-- Footer Section Starts Here --> 
<%= render 'layouts/footer' %>
<!-- Footer Section Ends Here --> 
                                 